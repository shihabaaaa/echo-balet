SELECT 
    V.M_PRODUCT_ID, 
    MP.NAME,
    V.MOVEMENTDATE,
    SUM(CASE WHEN V.MOVEMENTTYPE IN ('V+', 'P+') THEN V.MOVEMENTQTY ELSE NULL END) AS "Receipt_Return",
    SUM(CASE WHEN V.MOVEMENTTYPE = 'P-' THEN V.MOVEMENTQTY ELSE NULL END) AS Issue,
    AVG(MS.QTYONHAND) ONHAND,
    ROUND(V.COSTAVERAGE,2) "AVG_cost"
FROM M_Transaction_Detail_V V LEFT JOIN M_STORAGE MS on V.M_PRODUCT_ID = MS.M_PRODUCT_ID 
                              INNER JOIN M_PRODUCT MP on V.M_PRODUCT_ID = MP.M_PRODUCT_ID
WHERE 
    V.M_PRODUCT_ID in (1121974,1121056,1120819,1120809,1106893,1120127,1103944,1120810,1103825,1103943,1103824,1124247,1122201
                       ,1122704,1122156,1119197,112408,1123998,1124038)
    AND V.M_WAREHOUSE_ID = 1000740
    AND V.M_LOCATOR_ID = 1006001
    AND V.M_PRODUCT_CATEGORY_ID = 1000907
    AND V.MOVEMENTDATE >= TO_DATE('01-FEB-2025', 'DD-MON-YYYY')
    AND MP.M_PRODUCT_ID = MS.M_PRODUCT_ID
GROUP BY 
    V.M_PRODUCT_ID,MP.NAME, V.MOVEMENTDATE, V.COSTAVERAGE
 

order by V.MOVEMENTDATE 

